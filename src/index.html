<!-- build:remove -->
<%= t.include("partials/_top.html") %>
<!-- /build -->
<!-- build:css inline -->
<link rel="stylesheet" type="text/css" href="style.css">
<!-- /build -->





<!-- Code that goes within WCM Freeform -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

<script type="text/javascript">
// Twitter Intent
(function() {
  if (window.__twitterIntentHandler) return;
  var intentRegex = /twitter\.com\/intent\/(\w+)/,
      windowOptions = 'scrollbars=yes,resizable=yes,toolbar=no,location=yes',
      width = 550,
      height = 420,
      winHeight = screen.height,
      winWidth = screen.width;

  function handleIntent(e) {
    e = e || window.event;
    var target = e.target || e.srcElement,
        m, left, top;

    while (target && target.nodeName.toLowerCase() !== 'a') {
      target = target.parentNode;
    }

    if (target && target.nodeName.toLowerCase() === 'a' && target.href) {
      m = target.href.match(intentRegex);
      if (m) {
        left = Math.round((winWidth / 2) - (width / 2));
        top = 0;

        if (winHeight > height) {
          top = Math.round((winHeight / 2) - (height / 2));
        }

        window.open(target.href, 'intent', windowOptions + ',width=' + width +
                                           ',height=' + height + ',left=' + left + ',top=' + top);
        e.returnValue = false;
        e.preventDefault && e.preventDefault();
      }
    }
  }

  if (document.addEventListener) {
    document.addEventListener('click', handleIntent, false);
  } else if (document.attachEvent) {
    document.attachEvent('onclick', handleIntent);
  }
  window.__twitterIntentHandler = true;
}());

$(document).ready(function() {
document.getElementById('0').classList.add('active');

  $(window).scroll(function() {
    
  var window_top = document.body.scrollTop;
  var div_top = document.getElementById('stick-here').getBoundingClientRect().top + window_top;



  for (var i = 0; i < 9; i++) {
    var a = document.getElementById(i);
    var at = document.getElementById(i);
    //console.log(at);



    if (i == 8) {
      var ed_top = a.getBoundingClientRect().top + window_top - 460;
      var ede_top = a.getBoundingClientRect().bottom + window_top - 635;
    } else {
      var ed_top = a.getBoundingClientRect().top + window_top - 460;
      var ede_top = a.getBoundingClientRect().bottom + window_top - 460;
    }

    if (window_top > ed_top && window_top < ede_top) {
      at.classList.add('active');
      a.classList.add('active');
    } else {
      at.classList.remove('active');
      a.classList.remove('active');
    }
  }
});
});
</script>


<div class="dtf-container timeline">
	<div class="subhead timeline">The wines from this land have been famous for 150 years. Scroll down to see what sorts of wines the vineyardâ€™s different parcels are yielding today.</div>
</div>


<div class="timeline" id="timeline">
  <div id="stick-here"></div>	



<% json.tokalon_text.timeline.forEach(function(event, idx){ %>

  <div class="block-group" id="<%= idx %>">
    <div class="block-name">
      <div class="sticky-name">
        <div class="block-yr"><img src="<%=event.Image%>"></div>
      </div>

    </div>
    
    <div class="block-content">
    	<div class="block-yr-mobile"><img src="<%=event.Image%>"></div>

      <div class="block-text">
        <% if (event.Title) { %>
        <% console.log(event.Title)  %>
          <b><%=event.Title%></b> 
        <% } %>  
        <%=event.Text%>
      </div>
      <hr>
    </div>
  </div>
<% }); %>

<div class="block-content">
  <div id="credits">
    <div class="credits-title">Credits</div>
      <div>Research by<a href="mailto:dbaker@sfchronicle.com"> David R. Baker<br><a href="https://twitter.com/DavidBakerSF" target="_blank">@DavidBakerSF</a><br><br></div>
      Developed by <a href="mailto:lvilla@sfchronicle.com">Lucio Villa</a><br><a href="https://twitter.com/luciovilla" target="_blank">@luciovilla</a><br>
    </div>








<!-- build:remove -->
<%= t.include("partials/_bottom.html") %>
<!-- /build -->

